/*  ======================================================================== *

                                    주 의 사 항


    1. 계산 중간 흐름은 다음 문서를 보고 비교하는 것을 추천함

		http://grouper.ieee.org/groups/1619/email/pdf00046.pdf

 *  ======================================================================== */

#include <stdio.h>
#include "XTS_AES.h"
#include <string.h>
#include <stdint.h>
typedef unsigned char BYTE;
uint8_t iv[]  = { 
	// 직접 작성해서 테스트
	0x00, 0x00, 0x00, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f
};

uint8_t key[] = { 
	// 직접 작성해서 테스트
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00
};

uint8_t plain[] = { 
	// 직접 작성해서 테스트
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00
};

uint8_t cipher[] = { 
	// 직접 작성해서 테스트
	0x91, 0x7c, 0xf6, 0x9e,
	0xbd, 0x68, 0xb2, 0xec,
	0x9b, 0x9f, 0xe9, 0xa3,
	0xea, 0xdd, 0xa6, 0x92,
	0xcd, 0x43, 0xd2, 0xf5,
	0x95, 0x98, 0xed, 0x85,
	0x8c, 0x02, 0xc2, 0x65,
	0x2f, 0xbf, 0x92, 0x2e
};

int main(){
	BYTE tmp[32];

	// 암호화 테스트
	XTS_AES128(plain, tmp, 32, key, ENC);
	printf("XTS_AES Encryption: %s\n", 0 == strncmp((char*) cipher, (char*) tmp, 32) ? "SUCCESS!" : "FAILURE!");

	// 복호화 테스트
	XTS_AES128(tmp, cipher, 32, key, DEC);
	printf("XTS_AES Decryption: %s\n", 0 == strncmp((char*) tmp, (char*) plain, 32) ? "SUCCESS!" : "FAILURE!");

	return 0;
}